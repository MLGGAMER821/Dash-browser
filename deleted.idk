<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Dash Browser</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  /* (all your existing CSS stays the same — themes, tabs, toolbar, bookmarks, homepage, logo animation, etc.) */
</style>
</head>
<body>
  <!-- Tabs -->
  <div class="tabs" id="tabStrip"></div>

  <!-- Toolbar -->
  <div class="toolbar">
    <div class="brand">Dash Browser</div>
    <div class="omnibox">
      <input id="urlBar" class="url-input" value="dash:/newtab" placeholder="Search or enter address" />
      <button class="btn" id="goBtn">Go</button>
    </div>
    <button class="btn" id="themeBtn">Toggle Dark/Light</button>
    <select id="themeSelector" class="toolbar-select" title="Theme">
      <option value="">Light</option>
      <option value="dark">Dark Neon</option>
      <option value="cyberpunk">Cyberpunk</option>
      <option value="matrix">Matrix</option>
      <option value="sunset">Sunset</option>
    </select>
    <button class="about-btn" id="aboutBtn">About</button>
    <div class="add-tab" id="addTabBtn">＋</div>
  </div>

  <!-- Bookmarks -->
  <div class="bookmarks">
    <div class="bookmark" data-url="https://google.com/?igu=1">Google</div>
    <div class="bookmark" data-url="https://krizdev.github.io/Angry-Birds-Chrome-Revived/">Angry Birds</div>
  </div>

  <!-- Content -->
  <div class="content" id="contentArea"></div>

  <!-- About Popup -->
  <div id="aboutWindow" class="about-window">
    <div class="about-content">
      <h2>Copyright MLG</h2>
      <button id="closeAbout" class="btn">Close</button>
    </div>
  </div>

<script>
(function() {
  let tabs = [];
  let activeTabIndex = -1;
  let nextId = 0;

  const tabStrip = document.getElementById('tabStrip');
  const contentArea = document.getElementById('contentArea');
  const urlBar = document.getElementById('urlBar');
  const goBtn = document.getElementById('goBtn');
  const themeBtn = document.getElementById('themeBtn');
  const addTabBtn = document.getElementById('addTabBtn');
  const themeSelector = document.getElementById('themeSelector');

  function createHomepage() {
    const home = document.createElement('div');
    home.className = 'homepage visible';
    home.innerHTML = `
      <div class="home-inner">
        <div class="logo">Dash</div>
        <button class="btn" id="toggleLogo">Toggle Logo Animation</button>
        <div class="home-row">
          <div class="theme-toggle" data-action="toggle-theme">Toggle Dark/Light Mode</div>
        </div>
        <form class="search-form">
          <input class="search-input" type="text" placeholder="Search or type a URL" />
          <button class="search-btn" type="submit">Search</button>
        </form>
        <div class="shortcuts">
          <a class="shortcut" href="#" data-url="https://google.com/?igu=1">Google</a>
          <a class="shortcut" href="#" data-url="https://krizdev.github.io/Angry-Birds-Chrome-Revived/">Angry Birds</a>
        </div>
      </div>
    `;
    const form = home.querySelector('.search-form');
    const input = home.querySelector('.search-input');
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      navigateInput(input.value);
    });
    home.querySelectorAll('.shortcut').forEach(el => {
      el.addEventListener('click', (e) => {
        e.preventDefault();
        setActiveTabURL(el.dataset.url);
      });
    });
    const localToggle = home.querySelector('[data-action="toggle-theme"]');
    localToggle.addEventListener('click', toggleDarkLight);

    const logo = home.querySelector('.logo');
    const toggleLogoBtn = home.querySelector('#toggleLogo');
    toggleLogoBtn.addEventListener('click', () => {
      logo.classList.toggle('off');
    });

    return home;
  }

  function addTab(initialURL = 'dash:/newtab') {
    const id = nextId++;
    const pane = document.createElement('div');
    pane.className = 'tab-pane';
    pane.id = 'pane-' + id;

    const iframe = document.createElement('iframe');
    iframe.id = 'frame-' + id;

    const homepage = createHomepage();

    pane.appendChild(homepage);
    pane.appendChild(iframe);
    contentArea.appendChild(pane);

    const tabObj = { id, url: initialURL, pane, iframe, homepage };
    tabs.push(tabObj);
    switchTab(tabs.length - 1);
    setActiveTabURL(initialURL);
  }

  function switchTab(idx) {
    if (idx < 0 || idx >= tabs.length) return;
    activeTabIndex = idx;
    tabs.forEach(t => t.pane.classList.remove('active'));
    tabs[activeTabIndex].pane.classList.add('active');
    urlBar.value = tabs[activeTabIndex].url;
    renderActiveTab();
    renderTabStrip();
  }

  function closeTab(idx) {
    if (tabs.length === 1) return;
    const t = tabs[idx];
    t.pane.remove();
    tabs.splice(idx, 1);
    if (activeTabIndex >= tabs.length) activeTabIndex = tabs.length - 1;
    switchTab(activeTabIndex);
  }

  function renderTabStrip() {
    tabStrip.innerHTML = '';
    tabs.forEach((t, idx) => {
      const el = document.createElement('div');
      el.className = 'tab' + (idx === activeTabIndex ? ' active' : '');
      el.textContent = t.url === 'dash:/newtab' ? 'New Tab' : t.url;
      el.title = t.url;
      el.onclick = () => switchTab(idx);

      const close = document.createElement('span');
      close.className = 'close';
      close.textContent = '✕';
      close.onclick = (e) => { e.stopPropagation(); closeTab(idx); };

      el.appendChild(close);
      tabStrip.appendChild(el);
    });
  }

  function renderActiveTab() {
    const t = tabs[activeTabIndex];
    if (t.url === 'dash:/newtab') {
      t.homepage.classList.add('visible');
      t.iframe.classList.remove('visible');
      t.iframe.removeAttribute('src');
    } else {
      t.homepage.classList.remove('visible');
      t.iframe.classList.add('visible');
      if (t.iframe.src !== t.url) t.iframe.src = t.url;
    }
  }

  function setActiveTabURL(url) {
    const t = tabs[activeTabIndex];
    t.url = url;
    urlBar.value = url;
    renderActiveTab();
    renderTabStrip();
  }

  // ✅ Fixed omnibox navigation
  function navigateInput(raw) {
    const input = (raw || '').trim();
    if (!input || input === 'dash:/newtab') {
      setActiveTabURL('dash:/newtab');
      return;
    }
    let target;
    if (input.startsWith('http://') || input.startsWith('https://')) {
      target = input;
    } else if (input.includes('.') && !input.includes(' ')) {
      target = 'https://' + input;
    } else {
      target = 'https://google.com/?igu=1&q=' + encodeURIComponent(input);
    }
    setActiveTabURL(target);
  }

  function toggleDarkLight() {
    const root = document.documentElement;
    if (root.classList.contains('dark')) {
      root.classList.remove('dark');
    } else {
      root.classList.add('dark');
      root.classList.remove('cyberpunk', 'matrix', 'sunset');
    }
  }

  themeSelector.addEventListener('change', () => {
    const val = themeSelector.value;
    const root = document.documentElement;
    root.className = '';
    if (val) root.classList.add(val);
  });

  goBtn.addEventListener('click', () => navigateInput(urlBar.value));
  urlBar.addEventListener('keydown', (e) => { if (e.key === 'Enter') navigateInput(urlBar.value); });
  themeBtn.addEventListener('click', toggleDarkLight);
  addTabBtn.addEventListener('click', () => addTab('dash:/newtab'));

  document.querySelectorAll('.bookmark').forEach(b => {
    b.addEventListener('click', () => setActiveTabURL(b.dataset.url));
  });

  const aboutBtn = document.getElementById('aboutBtn');
  const aboutWindow = document.getElementById('
